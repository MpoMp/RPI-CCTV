<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link href="css/main.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="js/script.js"></script>
    <title>Report | RPI SecCam</title>
    <link rel="icon" type="image/png" href="../images/favicon.png" />
</head>

<body>
    <div class="example">
        <h1> Raspberry Pi Security Camera Project</h1>
        <h3><a href="../index.html"><img src="../images/rindex.png" style="width:60px" onmouseover="this.src='../images/rindex2.png'" onmouseout="this.src='../images/rindex.png'" /></a>
            <a href="../presentation/presentation.html"><img src="../images/rpresentation.png" style="width:60px" onmouseover="this.src='../images/rpresentation2.png'" onmouseout="this.src='../images/rpresentation.png'" /></a>
            <a href="report.html"><img src="../images/rreport.png" style="width:60px" onmouseover="this.src='../images/rreport2.png'" onmouseout="this.src='../images/rreport.png'" /></a>
        </h3>
        <div>
            <h2>Εισαγωγή στο θέμα</h2>
            <p class="report">Η εργασία αποτελείται από δύο παρόμοιες υλοποιήσεις συστήματος παρακολούθησης - κάμερας ασφαλείας, που έχουν ως βάση τον μικρο-υπολογιστή Raspberry Pi.
                <br>
                <br> Σκοπός της εργασίας είναι να παρουσιάσει μία οικονομική αλλά και σύγχρονη εναλλακτική στα συστήματα παρακολούθησης, η οποία είναι ευέλικτη και προσιτή ακόμα και σε άτομα με λιγοστές γνώσεις προγραμματισμού.</p>
            <br>
        </div>

        <h2>Συστήματα Παρακολούθησης</h2>
        <p class="report">Τα διαθέσιμα για αγορά συστήματα παρακολούθησης έρχονται σε πολλές μορφές και μεγάλο εύρος τιμών.
            <br> Μία απλή κάμερα ασφαλείας κοστίζει γύρω στα 70 ευρώ, αλλά δε διαθέτει λειτουργία stream πάνω από το internet, εντοπισμού κίνησης και αποθήκευσης φωτογραφιών /βίντεο.
            <br> Συστήματα που ικανοποιούν αυτές τις απαιτήσεις κοστίζουν τουλάχιστον 400 ευρώ, χωρίς να υπολογίζεται το κόστος εγκατάστασης και συντήρησης.</p>
        <br>

        <h2>Οι δικές μας υλοποιήσεις</h2>
        <p class="report">Με στόχο να δοθεί έμφαση στην ευελιξία του συστήματος σχεδιάσαμε δύο διαφορετικές υλοποιήσεις.
            <br>
            <br>
            <b>Υλοποίηση 1:</b>
            <br> Χρησιμοποιήθηκε η έκδοση MMAL του Motion, η οποία είναι αρκετά "ελαφριά" στους πόρους του Raspberry και υποστηρίζει το Raspberry Pi Camera Module - το οποίο είναι μέρος της υλοποίησης 1. Επιπλέον, για την αποστολή ειδοποιήσεων e-mail γράφτηκε ένα shell script που καλείται όταν εντοπίζεται κίνηση. Τέλος, για το ανέβασμα των φωτογραφιών χρησιμοποιήθηκε ένα shell script και η υπηρεσία dropbox.
            <br>
            <b>Κόστος: 73€</b> = Raspberry Pi Model B (40 €) + Camera Module (30 €) + SD Card 4GB (3 €)
            <br>
            <br>

            <b>Υλοποίηση 2:</b>
            <br> Χρησιμοποιήθηκε η βασική έκδοση του Motion, με το Motion Notify. Τα δεδομένα που καταγράφονται με τον εντοπισμό κίνησης στέλνονται σε χώρο στην υπηρεσία Google Drive.
            <br>
            <b>Κόστος: 65€</b> = Raspberry Pi Model B (40 €) + 3MP USB Camera (20 €) + SD Card 8GB (5 €)</p>
			<br>


        <h2>Hardware</h2>
        <p style="float: right;"><img src="../images/raspberryB.png" style="width:260px;padding-right:30px">
        </p>
        <p class="report">To <b>Raspberry Pi</b> είναι ένας υπολογιστής μεγέθους πιστωτικής κάρτας που πρωτοεμφανίστηκε στην αγορά το 2012. Εξοπλισμένο μόνο με τα απολύτως απαραίτητα κομμάτια hardware και με CPU των 700MHz, κατάφερε να σημειώσει πάνω από 5 εκατομμύρια πωλήσεις μέσα σε μόλις τρία χρόνια.
            <br>
            <br> Μέχρι στιγμής έχουν κυκλοφορήσει 5 εκδόσεις του, και η έκδοση που χρησιμοποιήθηκε για την εργασία είναι η B, με τα εξής χαρακτηριστικά:
            <br>
        </p>
        <ul class="report">
            <li>Chip: Broadcom BCM2835 SoC</li>
            <li>Core architecture: ARM11</li>
            <li>CPU: 700 MHz Low Power ARM1176JZFS Applications Processor</li>
            <li>GPU: Dual Core VideoCore IV® Multimedia Co-Processor (Provides Open GL ES 2.0, hardware-accelerated OpenVG, and 1080p30 H.264 high-profile decode. Capable of 1Gpixel/s, 1.5Gtexel/s or 24GFLOPs with texture filtering and DMA infrastructure.</li>
            <li>Memory: 512MB SDRAM</li>
            <li>Operating System: Boots from Micro SD card, running a version of the Linux operating system</li>
            <li>Dimensions: 85 x 56 x 17mm</li>
            <li>Power: Micro USB socket 5V, 2A</li>
        </ul>
        <p class="report">Επιπλέον, για την καταγραφή βίντεο και τη λήψη φωτογραφιών χρησιμοποιήθηκαν: το "Raspberry Pi Camera Module" και μία USB camera. Απαραίτητη για το streaming είναι η ύπαρξη DSL σύνδεσης και ενός αντίστοιχου απλού DSL Router.</p>
        <br>

        <h2>Software</h2>
        <p style="float: right;"><img src="../images/motion.png" style="width:100px;padding-right:100px">
        </p>
        <p class="report">Κύριο συστατικό της εργασίας είναι το ελεύθερο και ανοιχτού κώδικα λογισμικό <b>Motion</b>.
            <br> To Motion είναι ένα πρόγραμμα γραμμένο σε C, που έχει τη δυνατότητα να χρησιμοποιεί συνδεδεμένες κάμερες για να εντοπίζει κίνηση και να καταγράφει βίντεο και εικόνες. Παράλληλα, διαθέτει έναν απλό webcam server που επιτρέπει την προβολή του stream μέσω του internet.
            <br>
        </p>

        <p class="report">Για το σύστημα <b>αποστολής ειδοποιήσεων</b> χρησιμοποιήθηκαν plugins όπως το <a href="http://www.lavrsen.dk/foswiki/bin/view/Motion/MotionNotify">Motion Notify</a>. Τα πρόσθετα αυτά καλούνται μέσα από το Μotion, όταν εντοπίζεται κίνηση, και μέσω scripts σε Python και γλώσσας shell (π.χ. bash), στέλνουν ειδοποίηση μέσω e-mail, στη διεύθυνση που έχει ορίσει ο χρήστης. Αξίζει να σημειωθεί ότι υπάρχει δυνατότητα να στέλνονται ειδοποιήσεις ακόμα και σε κινητή συσκευή του χρήστη (smartphone, tablet) μέσω αντίστοιχων πρόσθετων εφαρμογών</p>

        <p class="report">Με χρήση κατάλληλων scripts γίνεται και το <b>uploading των στιγμιοτύπων</b> της κίνησης στο επιθυμητό cloud storage service ή οποιοδήποτε remote storage. Για τις ανάγκες τις εφαρμογής μας επιλέξαμε το MJPEG video format καθώς διευκολύνει τη μετάδοση του(<a href="https://en.wikipedia.org/wiki/Motion_JPEG#M-JPEG_over_HTTP">MJPEG over HTTP</a>). Το λογισμικό είναι παραμετροποιήσιμο σε μεγάλο βαθμό. Υπάρχουν δυνατότητες αλλαγής στο σύστημα εντοπισμού κίνησης, στο πότε θα στέλνονται ειδοποιήσεις, στο πότε θα στέλνονται και πότε θα διαγράφονται τα αποθηκευμένα αρχεία και σε πολλά ακόμη στοιχεία του λογισμικού.
        </p>

        <p class="report">Όσον αφορά στο <b>δικτυακό μέρος</b> του project, δεν χρειάζεται κάτι παραπάνω από μια απλή οικιακή σύνδεση DSL. Μόνη προϋπόθεση είναι να γίνει σωστά το port forwarding της διεύθυνσης και της θύρας όπου στέλνει το stream το Motion, και φυσικά να οριστούν τα στοιχεία (username & password) ώστε να είναι προστατευμένη η σελίδα. Για την παραμετροποίηση του port forwarding, μπορεί κανείς να κάνει μια σχετική αναζήτηση στο διαδίκτυο και να συμβουλευτεί το εγχειρίδιο χρήσης του router που διαθέτει. Δίνεται επίσης η επιλογή να χρησιμοποιηθεί κάποιο domain name για τη διευκόλυνση της πρόσβασης. Υπάρχουν οργανισμοί που διαθέτουν και δωρεάν υπηρεσίες DDNS.</p>
        <br>

        <h2>Αναλυτικά: Εγκατάσταση και παραμετροποίηση</h2>
        <p class="report">Η εγκατάσταση της βασικής έκδοσης του Motion μπορεί να γίνει και μέσω package manager και "χειροκίνητα". Για διανομές Linux όπως το Ubuntu, αρκεί η εντολή:
            <br>
            <br><strong>sudo apt-get install motion</strong>
            <br>
            <br> Για να κατεβάσετε και να κάνετε build τα πακέτα, υπάρχουν πολυάριθμοι οδηγοί στο διαδίκτυο, στη σελίδα του Motion που παραθέτουμε στις πηγές καθώς και αλλού. Το Motion-MMAL εγκαθίσταται κατόπιν της εγκατάστασης του Motion. Μπορείτε να δείτε την διαδικασία στον σχετικό σύνδεσμο στις πηγές.
        </p>

        <p class="report">Το Motion δεν έχει γραφικό περιβάλλον (GUI). Επομένως όλα γίνονται μέσω εντολών στο terminal που παρέχει το λειτουργικό σύστημα. Για την παραμετροποίηση, υπάρχει ένα <b>αρχείο config</b> (συγκεκριμένα motion.conf) όπου μπορούμε να ορίσουμε όλες τις μεταβλητές που χρησιμοποιεί το λογισμικό. Υπάρχουν μερικές επιλογές παραμετροποίησης που χρησιμοποιούνται μόνο αν το Motion γίνει build σε ένα σύστημα με τις αντίστοιχες software libraries εγκατεστημένες (MySQL, PostgreSQL and FFMPEG). Εμείς στις υλοποιήσεις μας χρησιμοποιούμε τις libraries του FFMPEG (libavcodec). Ορισμένα παραδείγματα παραμέτρων είναι οι:
            <br>
            <br><strong>ffmpeg_cap_new, ffmpeg_cap_motion, ffmpeg_filename, ffmpeg_bps, ffmpeg_variable_bitrate, ffmpeg_video_codec</strong>
            <br>
            <br> Μερικές ενδεικτικές παράμετροι που μας απασχόλησαν κατά τις δοκιμές είναι οι εξής:
            <ul class="report">
                <li><i>daemon</i>: ενεργοποίηση/απενεργοποίηση του daemon (background) mode</li>
                <li><i>framerate</i>: μέγιστος ρυθμός FPS που καταγράφει η κάμερα</li>
                <li><i>gap</i>: διάστημα κατόπιν της τελευταίας καταγραφής κίνησης (σε seconds) για το οποίο απενεργοποιείται το motion detection</li>
                <li><i>height, width</i>: διαστάσεις εικόνας που καταγράφει η κάμερα</li>
                <li><i>threshold</i>: κάτω όριο (σε αριθμό pixels που άλλαξαν) για τον εντοπισμό κίνησης</li>
                <li><i>webcam_port</i>: δικτυακή θύρα στην οποία θα εκπέμπεται το stream, η διεύθυνση IP είναι αυτή που έχει ανατεθεί στον υπολογιστή όπου τρέχει το Motion</li>
            </ul>
        </p>

        <p class="report">
            Η καταγραφή σφαλμάτων έχει υλοποιηθεί στο Motion έτσι ώστε τα σφάλματα κατά το daemon (background) mode να περνάνε στο syslog. Το syslog βρίσκεται, στα περισσότερα συστήματα Linux, στο αρχείο <i>/var/log/messages</i>, στο <i>/var/log/syslog</i> ή στο <i>/var/log/user.log</i>.
        </p>

        <p class="report">
            Όσον αφορά στην <b>παραμετροποίηση του DSL router</b>, αυτή εξαρτάται από το μοντέλο της συσκευής. Γενικά θα πρέπει να ελεγχθούν διάφορες ρυθμίσεις ασφαλείας που μπορεί να επηρεάσουν το stream (Built-In Firewall, ISP protection tools, port range blocks, κλπ.). Για την μετάδοση του stream προτείνεται να χρησιμοποιηθεί κάποια θύρα από την 9000 και άνω, που να μη χρησιμοποιείται από κάποια γνωστή υπηρεσία ή πρωτόκολλο δικτύου. Επίσης είναι απαραίτητο η θύρα αυτή να ρυθμιστεί ώστε να γίνει το forwarding της από το router. Αν χρησιμοποιηθεί κάποια υπηρεσία DDNS, είναι πιθανό να πρέπει να ρυθμιστεί και το router ανάλογα. Το Raspberry Pi μπορεί να συνδεθεί ενσύρματα (καλώδιο Ethernet) ή ασύρματα (WiFi adapter/Dongle) με το router.
        <br>Ας σημειωθεί εδώ ότι ο chrome/chromium browser δεν υποστηρίζει το mjpeg stream. Προτείνεται η χρήση εκδόσεων του firefox.
        <br></p>
        <div style="float:right"></div>
        <span class="span2" tabindex="0"><p class="report">Απόκρυψη Λεπτομερειών</p></span>
        <p class="alert" >sdasdas<br>sdasdas<br>sdasdas<br>sdasdas<br>sdasdas<br>sdasdas<br></p></div>   
		<span class="span3" tabindex="0"><p class="report">Εμφάνιση Λεπτομερειών</p></span>
		     
        <br>

        <h2>Σύγκριση και συμπεράσματα</h2>
        <p class="report">Όπως αναφέρεται και στην παρουσίαση, <b>μια εγκατάσταση CCTV</b> με συστήματα ασφαλείας που κυκλοφορούν στο εμπόριο, μπορεί να κοστίσει από 300 μέχρι και πάνω από 4000 ευρώ. Τέτοια συστήματα χρειάζεται, στην πλειοψηφία τους, να εγκατασταθούν από κάποιο τεχνικό που έχει γνώσεις και εμπειρία στον τομέα. Επίσης μπορεί να μην είναι και εύκολα παραμετροποιήσιμα από τον τελικό χρήστη. Άλλο ένα θέμα που τίθεται είναι ότι τέτοια συστήματα μπορεί κανείς να τα πάρει ως χρησιδάνειο από μια εταιρεία security η οποία θα ανιχνεύει και τον συναγερμό του σπιτιού. Επομένως οι εικόνες του σπιτιού περνάνε και στα "χέρια" τρίτων προσώπων.</p>
        <p class="report">Με την χρήση του συστήματος που προτείνουμε με <b>βάση το Raspberry Pi</b>, όλα τα παραπάνω προβλήματα αντιμετωπίζονται. Είναι μια κλιμακώσιμη λύση καθώς ο χρήστης μπορεί να ξοδέψει από λίγα μέχρι χιλιάδες ευρώ κατά βούληση. Αυτό εναπόκειται μόνο στο πόσο προηγμένο και θωρακισμένο επιθυμεί να είναι το σύστημα. Μπορεί να έχει από 1 έως πολλά Raspberry Pi στον χώρο με μία ή πολλές κάμερες (χαμηλής ή υψηλής ευκρίνειας). Μπορεί να ενσωματώσει τις κάμερες σε κουτιά ασφαλείας ή σε τοίχους. Μπορεί να προστατέψει τα μέσα αποθήκευσης των στιγμιοτύπων κίνησης όπως επιθυμεί. Σε φυσικό επίπεδο αλλά και ως προς το λογισμικό. Για όλα αυτά μπορεί κανείς να βρει άφθονο υλικό στο διαδίκτυο. Αντίθετα με μια συμβατική κάμερα ασφαλείας όπου πιθανότατα η μόνη πηγή υποστήριξης θα είναι το εγχειρίδιο χρήσης.
        </p>
        <p class="report">Εν κατακλείδι, στην εποχή μας είναι πλέον σχετικά εύκολο να εγκαταστήσει κάποιος, ακόμα και με βασικές γνώσεις Η/Υ και δικτύων, ένα σύστημα CCTV στο σπίτι ή την εργασία του. Οι επιλογές είναι πολλές καθώς αντί για το Raspberry Pi θα μπορούσε να χρησιμοποιηθεί οποιοσδήποτε υπολογιστής ή μικρο-υπολογιστής. Η επιλογή της κάμερας και του τρόπου εγκατάστασης εναπόκειται στον χρήστη και το κόστος είναι ανάλογο των αναγκών του. Με μια βασική σύνδεση DSL μπορεί επίσης να μεταδώσει σε πραγματικό χρόνο τις εικόνες από τις κάμερες σε ένα προστατευμένο (κατά το δυνατόν) stream.
        </p>
        <br>


        <h2>Αναφορές</h2>
        <ul class="report">
            <li><a href="https://www.raspberrypi.org/">Raspberry Pi, Official Webpage</a>
            <li><a href="http://www.lavrsen.dk/foswiki/bin/view/Motion/WebHome">Motion Webpage</a>
            <li><a href="https://github.com/dozencrows/motion/tree/mmal-test">Motion-MMAL on GitHub</a>
        </ul>
        <br>
        <br>
    </div>

    <footer class="footer2">
        <p>Created for the purposes of Multimedia Technology Course</p>
        <p>CS AUEB 2014-2015</p>
        <p><i>© Linuxoeideis -- {Bogdanos Michail #3100123, Thomas Charalampos #3100053, Stavropoulos Konstantinos #3100172} -- <a href="mailto:p3100172@dias.aueb.gr">Contact</a></i>
        </p>
        <br>
    </footer>
</body>

</html>
